<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Idéale Peinture - Nos peintures intérieures</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        body {
            font-family: 'Inter', 'Helvetica Neue', Arial, sans-serif;
            background-color: #f9fafb;
            color: #1f2937;
        }

        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .dropdown:hover .dropdown-menu {
            display: block;
        }

        .mobile-menu {
            transition: all 0.3s ease;
            max-height: 0;
            overflow: hidden;
        }

        .mobile-menu.open {
            max-height: 1000px;
        }

        .hero-gradient {
            background: linear-gradient(135deg, rgba(248,249,250,1) 0%, rgba(255,255,255,1) 100%);
        }

        .benefit-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .form-section {
            background: radial-gradient(circle at 10% 20%, rgba(248,249,250,0.8) 0%, rgba(255,255,255,1) 100%);
        }
        
        .product-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .category-card:hover .product-image {
            transform: scale(1.05);
        }
        
        .image-container {
            overflow: hidden;
        }
    </style>
</head>
<body class="font-sans antialiased text-gray-800">
    <header class="backdrop-blur-md bg-yellow-300/70 shadow-lg sticky top-0 z-50 border-b border-white/20">
  <div class="container mx-auto px-4">
    <div class="flex items-center justify-between md:justify-center py-4">

        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between md:justify-center py-4">
                <div class="flex items-center gap-3 md:gap-5 md:mx-auto">
                    <div class="flex items-center">
                       <div class="flex items-center">
        <a href="index.html">
          <img src="images/logo.png" alt="Idéale Peinture" class="h-12 w-auto hover:scale-105 transition-transform duration-200">
        </a>
      </div>
                    </div>
                    
                    <nav class="hidden md:flex items-center space-x-2 bg-white/70 rounded-full px-4 py-2 shadow-md">
                    <a href="index.html" class="px-4 py-2 font-semibold text-gray-700 hover:text-[#e3342f] transition duration-200 rounded-full hover:bg-yellow-100">Accueil</a>
                    <div class="dropdown relative group">
                        <button class="px-4 py-2 font-semibold text-gray-700 hover:text-[#e3342f] transition duration-200 rounded-full hover:bg-yellow-100 flex items-center">
                            Nos peintures <i class="fas fa-chevron-down ml-2 text-xs"></i>
                        </button>
                        <div class="dropdown-menu absolute hidden group-hover:block bg-white shadow-xl rounded-xl mt-2 w-64 z-50">
                            <div class="grid grid-cols-2 gap-6 p-6">
                                <div>
                                    <h4 class="font-bold text-[#FFD700] mb-2">Intérieures</h4>
                                    <ul class="space-y-1">
                                        <li><a href="intérieur.html" class="block py-1 text-gray-700 hover:text-[#e3342f] transition">Peintures mates</a></li>
                                        <li><a href="intérieur.html" class="block py-1 text-gray-700 hover:text-[#e3342f] transition">Peintures satinées</a></li>
                                        <li><a href="intérieur.html" class="block py-1 text-gray-700 hover:text-[#e3342f] transition">Peintures brillantes</a></li>
                                        <li><a href="spéciale.html" class="block py-1 text-gray-700 hover:text-[#e3342f] transition">Peintures spéciales</a></li>
                                    </ul>
                                </div>
                                <div>
                                    <h4 class="font-bold text-[#FFD700] mb-2">Extérieures</h4>
                                    <ul class="space-y-1">
                                        <li><a href="extérieur.html" class="block py-1 text-gray-700 hover:text-[#e3342f] transition">Peintures façade</a></li>
                                        <li><a href="extérieur.html" class="block py-1 text-gray-700 hover:text-[#e3342f] transition">Peintures balcons/terrasses</a></li>
                                        <li><a href="extérieur.html" class="block py-1 text-gray-700 hover:text-[#e3342f] transition">Peintures anti-humidité</a></li>
                                        <li><a href="extérieur.html" class="block py-1 text-gray-700 hover:text-[#e3342f] transition">Peintures protection bois</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <a href="index.html#nos-realisations" class="px-4 py-2 font-semibold text-gray-700 hover:text-[#e3342f] transition duration-200 rounded-full hover:bg-yellow-100">Réalisations</a>
                    <a href="index.html#a-propos" class="px-4 py-2 font-semibold text-gray-700 hover:text-[#e3342f] transition duration-200 rounded-full hover:bg-yellow-100">À propos</a>
                    <a href="inspiration.html" class="px-4 py-2 font-semibold text-gray-700 hover:text-[#e3342f] transition duration-200 rounded-full hover:bg-yellow-100">Blogs & inspiration</a>
                    <a href="contact.html" class="px-4 py-2 font-semibold text-gray-700 hover:text-[#e3342f] transition duration-200 rounded-full hover:bg-yellow-100">Contact</a>
                    <a href="devenir distributeur.html" class="ml-2 px-4 py-2 bg-[#FFD700] text-[#e3342f] font-bold rounded-full shadow hover:bg-[#e3342f] hover:text-white transition duration-200">Devenir distributeur</a>
                </nav>
                </div>
                
                <button id="mobile-menu-button" class="md:hidden text-[#e3342f] bg-white rounded-full p-2 shadow hover:bg-yellow-100 transition">
                    <i class="fas fa-bars text-2xl"></i>
                </button>
            </div>
            
            <div id="mobile-menu" class="mobile-menu md:hidden bg-white/90 rounded-xl shadow-lg mt-2 p-4">
                <a href="index.html" class="block px-4 py-2 rounded-full font-semibold text-gray-700 hover:text-[#e3342f] hover:bg-yellow-100 transition">Accueil</a>
                <div class="relative">
                    <button onclick="toggleSubMenu('paint-submenu')" class="w-full flex justify-between items-center px-4 py-2 rounded-full font-semibold text-gray-700 hover:text-[#e3342f] hover:bg-yellow-100 transition">
                        Nos peintures <i class="fas fa-chevron-down text-xs"></i>
                    </button>
                    <div id="paint-submenu" class="hidden pl-4">
                        <a href="intérieur.html" class="block px-4 py-2 rounded-full font-semibold text-gray-700 hover:text-[#e3342f] hover:bg-yellow-100 transition">Peintures Intérieures</a>
                        <a href="extérieur.html" class="block px-4 py-2 rounded-full font-semibold text-gray-700 hover:text-[#e3342f] hover:bg-yellow-100 transition">Peintures Extérieures</a>
                        <a href="spéciale.html" class="block px-4 py-2 rounded-full font-semibold text-gray-700 hover:text-[#e3342f] hover:bg-yellow-100 transition">Peintures Spéciales</a>
                    </div>
                </div>
                <a href="index.html#nos-realisations" class="block px-4 py-2 rounded-full font-semibold text-gray-700 hover:text-[#e3342f] hover:bg-yellow-100 transition">Réalisations</a>
                <a href="index.html#a-propos" class="block px-4 py-2 rounded-full font-semibold text-gray-700 hover:text-[#e3342f] hover:bg-yellow-100 transition">À propos</a>
                <a href="inspiration.html" class="block px-4 py-2 rounded-full font-semibold text-gray-700 hover:text-[#e3342f] hover:bg-yellow-100 transition">Blogs & inspiration</a>
                <a href="contact.html" class="block px-4 py-2 rounded-full font-semibold text-gray-700 hover:text-[#e3342f] hover:bg-yellow-100 transition">Contact</a>
                <a href="devenir distributeur.html" class="block px-4 py-2 rounded-full font-bold bg-[#FFD700] text-[#e3342f] mt-2 shadow hover:bg-[#e3342f] hover:text-white transition">Devenir distributeur</a>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <section class="text-center mb-16" data-aos="fade-up">
            <h1 class="text-4xl font-bold text-gray-900 mb-4">Explorez nos peintures intérieures</h1>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto">Donnez vie à vos espaces avec des finitions et des couleurs qui vous ressemblent.</p>
        </section>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-16">
            <!-- Peinture Mate -->
            <div class="category-card bg-white rounded-xl shadow-md overflow-hidden transition-all duration-300 ease-in-out" data-aos="fade-up" data-aos-delay="100">
                <div class="image-container">
                    <img src="images/idealePeintures Mates.png" 
                         alt="Peinture mate pour intérieur" 
                         class="product-image">
                </div>
                <div class="p-6">
                    <h3 class="text-xl font-semibold mb-2">Peintures Mates</h3>
                    <p class="text-gray-600 mb-4">Idéales pour les plafonds et les pièces à faible passage, elles masquent les imperfections et offrent une finition sobre et élégante.</p>
                    <a href="#" data-product="Peintures Mates" class="order-button inline-flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-300 ease-in-out">
                        Commander
                    </a>
                </div>
            </div>

            <!-- Peinture Satinée -->
            <div class="category-card bg-white rounded-xl shadow-md overflow-hidden transition-all duration-300 ease-in-out" data-aos="fade-up" data-aos-delay="200">
                <div class="image-container">
                    <img src="images/IDEALEPeintures Satinées.png" 
                         alt="Peinture satinée pour salon" 
                         class="product-image">
                </div>
                <div class="p-6">
                    <h3 class="text-xl font-semibold mb-2">Peintures Satinées</h3>
                    <p class="text-gray-600 mb-4">Polyvalentes et résistantes, elles sont parfaites pour les pièces de vie comme le salon ou les chambres. Leur léger reflet apporte de la lumière.</p>
                    <a href="#" data-product="Peintures Satinées" class="order-button inline-flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-300 ease-in-out">
                        Commander
                    </a>
                </div>
            </div>

            <!-- Peinture Brillante -->
            <div class="category-card bg-white rounded-xl shadow-md overflow-hidden transition-all duration-300 ease-in-out" data-aos="fade-up" data-aos-delay="300">
                <div class="image-container">
                    <img src="images/IDEALEPeintures Brillantes.png" 
                         alt="Peinture brillante pour salle de bain" 
                         class="product-image">
                </div>
                <div class="p-6">
                    <h3 class="text-xl font-semibold mb-2">Peintures Brillantes</h3>
                    <p class="text-gray-600 mb-4">Très résistantes et faciles à nettoyer, elles sont idéales pour les pièces d'eau (cuisine, salle de bain) et pour sublimer les boiseries.</p>
                    <a href="#" data-product="Peintures Brillantes" class="order-button inline-flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-300 ease-in-out">
                        Commander
                    </a>
                </div>
            </div>
        </div>

 
    <div id="order-choice-modal" class="hidden fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4 transition-opacity duration-300">
        <div class="bg-white rounded-xl shadow-2xl p-8 max-w-md w-full relative" data-aos="zoom-in" data-aos-duration="400">
            <button id="close-modal-button" class="absolute top-4 right-4 text-gray-400 hover:text-gray-700 transition-colors">
                <i class="fas fa-times text-2xl"></i>
            </button>
            
            <div id="choice-view">
                <h3 class="text-2xl font-bold text-center text-gray-800 mb-4">Passer ma commande</h3>
                <p class="text-center text-gray-600 mb-8">Choisissez votre méthode de contact préférée.</p>
                
                <div class="space-y-4">
                    <a id="modal-whatsapp-button" href="#" target="_blank" class="flex items-center justify-center w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg transition duration-300 shadow-md hover:shadow-lg">
                        <i class="fab fa-whatsapp mr-3 text-xl"></i> Continuer sur WhatsApp
                    </a>
                    <button id="modal-email-choice-button" class="flex items-center justify-center w-full bg-gray-700 hover:bg-gray-800 text-white font-bold py-3 px-4 rounded-lg transition duration-300 shadow-md hover:shadow-lg">
                        <i class="fas fa-envelope mr-3 text-xl"></i> Continuer par E-mail
                    </button>
                </div>
            </div>

            <div id="email-form-view" class="hidden">
                <button id="back-to-choice-button" class="absolute top-4 left-4 text-gray-400 hover:text-gray-700 transition-colors">
                    <i class="fas fa-arrow-left text-xl"></i>
                </button>
                <h3 class="text-2xl font-bold text-center text-gray-800 mb-6">Commander par E-mail</h3>
                
                <form action="https://getform.io/f/bwnykqga" method="POST" class="space-y-4">
                    <input type="hidden" id="form-product-name" name="Produit">
                    
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700">Votre E-mail</label>
                        <input type="email" name="email" id="email" required class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                    </div>

                    <div>
                        <label for="message" class="block text-sm font-medium text-gray-700">Message (optionnel)</label>
                        <textarea name="message" id="message" rows="4" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="Ajoutez des détails sur votre commande ici..."></textarea>
                    </div>

                    <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 shadow-md hover:shadow-lg">
                        Envoyer la demande
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Footer -->
<footer class="bg-gray-900 text-white py-12">
    <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
            <div>
                <div class="flex items-center mb-4 gap-3">
                    <div class="w-14 h-14 bg-white border-4 border-[#FFD700] flex items-center justify-center rounded-full shadow-lg overflow-hidden">
                        <img src="images/logo.png" alt="Logo Idéale Peinture" class="w-full h-full object-cover rounded-full">
                    </div>
                    <span class="flex flex-row items-end leading-tight">
                        <span class="text-2xl font-extrabold text-white tracking-tight mr-2">Idéale</span>
                        <span class="text-lg font-bold text-[#e3342f] tracking-wide">Peinture</span>
                    </span>
                </div>
                <p class="text-gray-400 mb-6">Votre spécialiste en peintures intérieures et extérieures depuis 2019.</p>

                <div class="flex space-x-4">
                    <a href="https://web.facebook.com/profile.php?id=61550743929810" target="_blank" rel="noopener noreferrer" aria-label="Facebook Idéale Peinture" class="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center text-xl transition-all duration-300 hover:bg-blue-700 hover:scale-110">
                        <i class="fab fa-facebook-f"></i>
                    </a>

                    <a href="#" onclick="showWhatsappPopup()" aria-label="WhatsApp" class="w-10 h-10 bg-green-600 text-white rounded-full flex items-center justify-center text-xl transition-all duration-300 hover:bg-green-700 hover:scale-110">
                        <i class="fab fa-whatsapp"></i>
                    </a>

                    <a href="https://www.tiktok.com/@ideale.peinture" target="_blank" rel="noopener noreferrer" aria-label="TikTok Idéale Peinture" class="w-10 h-10 bg-black text-white rounded-full flex items-center justify-center text-xl transition-all duration-300 hover:bg-gray-800 hover:scale-110">
                        <i class="fab fa-tiktok"></i>
                    </a>

                    <a href="https://www.instagram.com/idealepeinturetg/" target="_blank" rel="noopener noreferrer" aria-label="Instagram Idéale Peinture" class="w-10 h-10 text-white rounded-full flex items-center justify-center text-xl bg-gradient-to-r from-purple-500 via-pink-500 to-yellow-500 transition-all duration-300 hover:scale-110">
                        <i class="fab fa-instagram"></i>
                    </a>
                </div>
            </div>

            <div>
                <h3 class="text-lg font-bold mb-4">Nos produits</h3>
                <ul class="space-y-2">
                    <li><a href="intérieur.html" class="text-gray-400 hover:text-white">Peintures Intérieures</a></li>
                    <li><a href="extérieur.html" class="text-gray-400 hover:text-white">Peintures Extérieures</a></li>
                    <li><a href="spéciale.html" class="text-gray-400 hover:text-white">Peintures Spéciales</a></li>
                </ul>
            </div>

            <div>
                <h3 class="text-lg font-bold mb-4">Nos services</h3>
                <ul class="space-y-2">
                    <li><a href="#" class="text-gray-400 hover:text-white">Conseil couleur</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-white">Devis</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-white">Livraison</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-white">Application pro</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-white">Rénovation complète</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-white">Service après-vente</a></li>
                </ul>
            </div>

            <div>
                <h3 class="text-lg font-bold mb-4">Informations</h3>
                <ul class="space-y-2">
                    <li><a href="#a-propos" class="text-gray-400 hover:text-white">À propos</a></li>
                    <li><a href="#nos-realisations" class="text-gray-400 hover:text-white">Nos réalisations</a></li>
                    <li><a href="inspiration.html" class="text-gray-400 hover:text-white">Conseils & inspiration</a></li>
                    <li><a href="devenir distributeur.html" class="text-gray-400 hover:text-white">Devenir distributeur</a></li>
                </ul>
            </div>
        </div>

        <div class="border-t border-gray-800 mt-12 pt-8 flex flex-col md:flex-row justify-between items-center">
            <p class="text-gray-400 mb-4 md:mb-0">© 2025 powered by ideale peinture. Tous droits réservés.</p>
            </div>
    </div>
</footer>

<div id="whatsapp-popup" class="fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center hidden z-[100]">
    <div class="bg-white p-6 rounded-lg w-96">
        <h2 class="text-xl font-semibold mb-4 text-gray-800">Choisissez un numéro WhatsApp</h2>
        <ul>
            <li class="mb-4">
                <button onclick="redirectToWhatsapp('22890792752')" class="w-full bg-green-600 text-white p-3 rounded-lg hover:bg-green-700 transition">
                    +22890792752
                </button>
            </li>
            <li>
                <button onclick="redirectToWhatsapp('98723961')" class="w-full bg-green-600 text-white p-3 rounded-lg hover:bg-green-700 transition">
                    +22898723961
                </button>
            </li>
        </ul>
        <button onclick="closeWhatsappPopup()" class="mt-4 w-full bg-gray-500 text-white p-3 rounded-lg hover:bg-gray-600 transition">
            Fermer
        </button>
    </div>
</div>

<div class="fixed bottom-6 right-6 z-50">
    <button id="chat-button" class="w-16 h-16 bg-blue-600 text-white rounded-full flex items-center justify-center shadow-lg hover:bg-blue-700 transition">
        <i class="fas fa-comment-dots text-2xl"></i>
    </button>
    
    <div id="chat-window" class="hidden absolute bottom-20 right-0 w-80 bg-white rounded-lg shadow-xl overflow-hidden">
        <div class="bg-blue-600 text-white px-4 py-3 flex justify-between items-center">
            <h3 class="font-bold">Vos commentaires</h3>
            <button id="close-chat" class="text-white hover:text-gray-200">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div id="chat-messages" class="p-4 h-64 overflow-y-auto">
            <div class="mb-4">
                <div class="bg-blue-100 text-gray-800 rounded-lg p-3 max-w-xs">
                    <p>Bonjour ! Partagez votre expérience avec nos services ou posez-nous vos questions.</p>
                </div>
                <p class="text-xs text-gray-500 mt-1" id="welcome-time"></p>
            </div>
        </div>
        
        <div class="border-t p-4">
            <div class="flex">
                <input type="text" id="chat-input" placeholder="Tapez votre message..." class="flex-grow px-4 py-2 border rounded-l-md focus:outline-none">
                <button id="send-message" class="bg-blue-600 text-white px-4 py-2 rounded-r-md hover:bg-blue-700">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
            <p class="text-xs text-gray-500 mt-2 text-center">
                Vos commentaires nous aident à améliorer nos services
            </p>
        </div>
    </div>
</div>

<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>
// Menu mobile
document.getElementById('mobile-menu-button')?.addEventListener('click', function() { // Ajout de '?' pour éviter une erreur si le bouton n'existe pas
    document.getElementById('mobile-menu')?.classList.toggle('hidden'); // Ajout de '?'
});

// Navigation fluide
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const targetId = this.getAttribute('href');
        if (targetId === '#') return;
        const targetElement = document.querySelector(targetId);
        if (targetElement) {
            window.scrollTo({
                top: targetElement.offsetTop - 80,
                behavior: 'smooth'
            });
            const mobileMenu = document.getElementById('mobile-menu');
            if (mobileMenu && !mobileMenu.classList.contains('hidden')) { // Vérification ajoutée
                mobileMenu.classList.add('hidden');
            }
        }
    });
});

// Modale de commande (les fonctions restent inchangées car non incluses dans le HTML de la footer/chat)
const orderModal = document.getElementById('orderModal');
const closeModal = document.getElementById('closeModal');
const orderForm = document.getElementById('orderForm');
const productName = document.getElementById('productName');
const productInfo = document.getElementById('productInfo');
const submitButton = document.getElementById('submitButton');

let currentProduct = '';
let currentPrice = '';

document.querySelectorAll('.order-button').forEach(button => {
    button.addEventListener('click', () => {
        currentProduct = button.getAttribute('data-product');
        currentPrice = button.getAttribute('data-price') || '';
        showModal();
    });
});

function showModal() {
    if (orderModal) orderModal.style.display = 'flex';
    if (productName) productName.value = `${currentProduct} - ${currentPrice}`;
    if (productInfo) productInfo.textContent = `${currentProduct} - ${currentPrice}`;
    const nameField = document.getElementById('name');
    if (nameField) nameField.focus();
}

function closeModalFunc() {
    if (orderModal) orderModal.style.display = 'none';
    if (orderForm) orderForm.reset();
    if (submitButton) {
        submitButton.disabled = false;
        submitButton.innerHTML = '<i class="fas fa-paper-plane mr-2"></i>Envoyer ma commande';
    }
}

if (closeModal) closeModal.addEventListener('click', closeModalFunc);

if (orderModal) {
    orderModal.addEventListener('click', (e) => {
        if (e.target === orderModal) closeModalFunc();
    });
}

document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && orderModal && orderModal.style.display === 'flex') {
        closeModalFunc();
    }
});

// Soumission du formulaire
if (orderForm) {
    orderForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        if (submitButton) {
            submitButton.disabled = true;
            submitButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Envoi en cours...';
        }

        try {
            const formData = new FormData(orderForm);
            const response = await fetch('https://getform.io/f/arogmwwb', {
                method: 'POST',
                body: formData
            });

            if (!response.ok) throw new Error('Erreur lors de l\'envoi');

            alert('✅ Commande envoyée avec succès !\n\nNous avons bien reçu votre commande.\nNotre équipe vous contactera sous 24 heures.');
            closeModalFunc();

        } catch (error) {
            console.error('Erreur lors de l\'envoi :', error);
            alert('Une erreur est survenue lors de l\'envoi de votre commande. Veuillez réessayer.');
            if (submitButton) {
                submitButton.disabled = false;
                submitButton.innerHTML = '<i class="fas fa-paper-plane mr-2"></i>Envoyer ma commande';
            }
        }
    });
}


// Validation en temps réel
const requiredFields = ['name', 'email', 'phone'];

function validateForm() {
    const isValid = requiredFields.every(id => {
        const field = document.getElementById(id);
        return field && field.value.trim() !== '';
    });
    if (submitButton) {
        submitButton.disabled = !isValid;
        submitButton.style.opacity = isValid ? '1' : '0.6';
    }
}

requiredFields.forEach(fieldId => {
    const field = document.getElementById(fieldId);
    if (field) {
        field.addEventListener('input', validateForm);
    }
});


// Configuration et fonctions de la popup WhatsApp (nettoyé des doublons)
const whatsappPopup = document.getElementById('whatsapp-popup');

function showWhatsappPopup() {
    if (whatsappPopup) whatsappPopup.classList.remove('hidden');
}

function closeWhatsappPopup() {
    if (whatsappPopup) whatsappPopup.classList.add('hidden');
}

function redirectToWhatsapp(number) {
    const message = encodeURIComponent("Bonjour ! Je vous contacte depuis votre site fictif.");
    window.open(`https://wa.me/${number}?text=${message}`, '_blank');
    closeWhatsappPopup(); // Close popup after redirect
}


// Configuration du chat
const chatButton = document.getElementById('chat-button');
const chatWindow = document.getElementById('chat-window');
const closeChat = document.getElementById('close-chat');
const chatMessages = document.getElementById('chat-messages');
const chatInput = document.getElementById('chat-input');
const sendMessageBtn = document.getElementById('send-message');
const welcomeTime = document.getElementById('welcome-time');

if (welcomeTime) {
    welcomeTime.textContent = new Date().toLocaleTimeString('fr-FR', {
        hour: '2-digit',
        minute: '2-digit'
    });
}

let chatHistory = JSON.parse(localStorage.getItem('idealePeintureChat')) || [];

function loadChatHistory() {
    if (!chatMessages) return;

    chatMessages.innerHTML = '';

    const welcomeMsg = document.createElement('div');
    welcomeMsg.className = 'mb-4';
    welcomeMsg.innerHTML = `
        <div class="bg-blue-100 text-gray-800 rounded-lg p-3 max-w-xs">
            <p>Bonjour ! Partagez votre expérience avec nos services ou posez-nous vos questions.</p>
        </div>
        <p class="text-xs text-gray-500 mt-1">${new Date().toLocaleTimeString('fr-FR', {
            hour: '2-digit',
            minute: '2-digit'
        })}</p>
    `;
    chatMessages.appendChild(welcomeMsg);

    chatHistory.forEach(msg => {
        addMessageToChat(msg.text, msg.sender, msg.timestamp, false);
    });

    chatMessages.scrollTop = chatMessages.scrollHeight;
}

function addMessageToChat(text, sender, timestamp, saveToStorage = true) {
    if (!chatMessages) return;

    const messageDiv = document.createElement('div');
    messageDiv.className = `mb-4 ${sender === 'user' ? 'text-right' : ''}`;

    const bubbleClass = sender === 'user'
        ? 'bg-blue-600 text-white rounded-lg p-3 max-w-xs ml-auto'
        : 'bg-gray-100 text-gray-800 rounded-lg p-3 max-w-xs';

    messageDiv.innerHTML = `
        <div class="${bubbleClass}">
            <p>${text}</p>
        </div>
        <p class="text-xs text-gray-500 mt-1 ${sender === 'user' ? 'text-right' : ''}">
            ${timestamp}
        </p>
    `;

    chatMessages.appendChild(messageDiv);
    chatMessages.scrollTop = chatMessages.scrollHeight;

    if (saveToStorage) {
        chatHistory.push({
            text: text,
            sender: sender,
            timestamp: timestamp
        });
        localStorage.setItem('idealePeintureChat', JSON.stringify(chatHistory));
    }
}

function sendUserMessage() {
    if (!chatInput) return;
    const message = chatInput.value.trim();

    if (message === '') return;

    const timestamp = new Date().toLocaleTimeString('fr-FR', {
        hour: '2-digit',
        minute: '2-digit'
    });

    addMessageToChat(message, 'user', timestamp);

    setTimeout(() => {
        const responses = [
            "Merci pour votre commentaire ! Nous prenons en compte chaque retour pour améliorer nos services.",
            "Votre avis est précieux pour nous. L'équipe Idéale Peinture vous remercie !",
            "Nous avons bien reçu votre message. Nos équipes en prendront connaissance rapidement.",
            "Merci de partager votre expérience. Nous travaillons continuellement à satisfaire nos clients.",
            "Votre feedback nous aide à progresser. Merci pour votre confiance !"
        ];

        const randomResponse = responses[Math.floor(Math.random() * responses.length)];
        const responseTimestamp = new Date().toLocaleTimeString('fr-FR', {
            hour: '2-digit',
            minute: '2-digit'
        });

        addMessageToChat(randomResponse, 'bot', responseTimestamp);
    }, 1000);

    sendCommentToEmail(message, timestamp);
    chatInput.value = '';
}

function sendCommentToEmail(message, timestamp) {
    const formData = new FormData();
    formData.append('name', 'Visiteur du site');
    formData.append('email', 'commentaire@idealepeinture.com');
    formData.append('subject', 'Nouveau commentaire sur le site');
    formData.append('message', `Commentaire reçu le ${new Date().toLocaleDateString('fr-FR')} à ${timestamp}:\n\n${message}`);

    fetch('https://getform.io/f/bwnykqga', {
        method: 'POST',
        body: formData,
        headers: {
            'Accept': 'application/json'
        }
    })
    .then(response => {
        if (response.ok) {
            console.log('Commentaire envoyé avec succès');
        } else {
            console.error('Erreur lors de l\'envoi du commentaire');
        }
    })
    .catch(error => {
        console.error('Erreur:', error);
    });
}

if (chatButton && chatWindow) {
    chatButton.addEventListener('click', function() {
        chatWindow.classList.toggle('hidden');
        loadChatHistory();
        if (!chatWindow.classList.contains('hidden') && chatInput) {
            chatInput.focus();
        }
    });
}

if (closeChat && chatWindow) {
    closeChat.addEventListener('click', function() {
        chatWindow.classList.add('hidden');
    });
}

if (sendMessageBtn) sendMessageBtn.addEventListener('click', sendUserMessage);

if (chatInput) {
    chatInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            sendUserMessage();
        }
    });
}

// Fermeture du chat en cliquant à l'extérieur
document.addEventListener('click', function(e) {
    if (chatWindow && chatButton && !chatWindow.contains(e.target) && !chatButton.contains(e.target)) {
        chatWindow.classList.add('hidden');
    }
});

// Animation du bouton de chat
setTimeout(() => {
    if (chatButton) {
        chatButton.classList.add('animate-bounce');
        setTimeout(() => {
            chatButton.classList.remove('animate-bounce');
        }, 2000);
    }
}, 3000);

// Initialiser AOS
if (typeof AOS !== 'undefined') {
    AOS.init({ duration: 800, easing: 'ease-in-out', once: true });
}
</script>

</body>
</html>
